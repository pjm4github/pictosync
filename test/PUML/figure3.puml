@startuml FIG3_Zero_Trust_Authority
!theme plain
skinparam backgroundColor #FEFEFE
skinparam defaultFontName Arial
skinparam defaultFontSize 11
skinparam rectangle {
  RoundCorner 8
}
skinparam component {
  RoundCorner 6
}

title **FIG. 3 — Zero-Trust Operator Authority Framework**

rectangle "**Identity Verification Layer**\n(Every Interaction — No Persistent Sessions)" as identity #FFF0E0 {
  component "Multi-Factor\nAuthentication" as mfa #FFE0B0
  component "Device Certificate\nValidation" as devcert #FFE0B0
  component "Corporate IdP\n(SAML/OIDC)" as idp #FFE0B0
  component "Role Claim\nExtraction" as roleclaim #FFE0B0

  mfa -right-> devcert
  devcert -right-> idp
  idp -right-> roleclaim
}

rectangle "**Skill Profile Store**\n(Dynamic, Per-Operator)" as skillstore #F0E8FF {
  component "Domain Proficiency\nScores" as proficiency #E0D0FF
  component "Trust Score\n(Multi-dimensional)" as trustscore #E0D0FF
  component "Activity History\n& Decay Clock" as activity #E0D0FF

  note bottom of proficiency
    Example operator profile:
    ├─ IEC 61850:    0.85 (Expert)
    ├─ SCADA/DNP3:   0.82 (Expert)
    ├─ AMI Systems:  0.55 (Proficient)
    ├─ Maximo EAM:   0.25 (Learning)
    └─ Kraken CIS:   0.10 (New)
  end note
}

rectangle "**Policy Engine**\n(Managed by Security Team)" as policyengine #E8F0FF {
  component "Domain → Skill\nMapping Rules" as domainmap #CCE0FF
  component "Threshold\nConfiguration" as thresholds #CCE0FF
  component "Escalation\nRouting" as escalation #CCE0FF
}

rectangle "**Authorization Decision**" as authdecision #F0FFF0 {
  component "Skill ≥ 0.7 +\nDomain Match" as tier1 #CCFFCC
  component "Skill 0.4–0.7\n→ Peer Review" as tier2 #FFFFCC
  component "Skill < 0.4 or\nDomain Mismatch\n→ Escalate/Deny" as tier3 #FFCCCC
}

rectangle "**Skill Evolution Engine**\n(Feedback-Driven)" as evolution #FFF8F0 {
  component "Successful review\n→ skill +Δ" as evoup1 #E0FFE0
  component "Caught AI error\n→ skill ++Δ" as evoup2 #C0FFC0
  component "Improved skill code\n→ skill +++Δ" as evoup3 #A0FFA0
  component "Approved bad result\n→ skill −Δ" as evodown #FFE0E0
  component "Inactivity\n→ decay (30d)" as evodecay #FFF0E0
}

rectangle "**Organizational Skill Graph**" as orggraph #F8F0FF {
  component "Cross-Operator\nExpertise Topology" as topology #E8E0FF
  component "Consultation\nRouting" as routing #E8E0FF
  component "Knowledge\nTransfer Tracking" as transfer #E8E0FF
}

' === Connections ===
roleclaim -down-> domainmap : authenticated\nidentity + role
proficiency -down-> domainmap : operator\nskill scores
trustscore -down-> thresholds : trust\ndimensions

domainmap -down-> tier1
domainmap -down-> tier2
domainmap -down-> tier3
thresholds --> tier1
thresholds --> tier2
thresholds --> tier3
escalation --> tier3

tier1 -down-> evolution : outcome\nfeedback
tier2 -down-> evolution : outcome\nfeedback

evoup1 -right-> proficiency : update\nscores
evoup2 -right-> proficiency
evoup3 -right-> proficiency
evodown -right-> proficiency
evodecay -right-> activity

proficiency --> topology : aggregate\nskills
topology --> routing : route\nconsultations
routing --> escalation : escalation\ntargets

note bottom of authdecision
  **Trust Score Dimensions:**
  1. Domain expertise level
  2. Historical review accuracy
  3. Recency of activity
  4. Scope alignment with request
end note

@enduml